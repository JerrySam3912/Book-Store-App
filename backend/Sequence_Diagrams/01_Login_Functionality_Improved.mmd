sequenceDiagram
    participant User
    participant Client as Client (Frontend)
    participant Controller as Controller (Backend)
    participant DB as Database (MySQL)
    
    Note over User,DB: 5.3.6.1. Login Functionality
    
    User->>+Client: Open login page
    
    User->>Client: Submit credentials (email, password)
    Client->>+Controller: POST /api/auth/login\n{ email, password }
    
    Note over Controller,DB: Validate User Credentials
    
    Controller->>+DB: SELECT id, username, password_hash,\nrole, is_active FROM users\nWHERE email = ?
    DB-->>-DB: user record or empty
    DB-->>Controller: user record or empty
    
    alt [user not found]
        Controller-->>-Client: 401 Invalid email or password
        Client-->>User: Display error message
    else [user found]
        alt [is_active == 0] Account Banned
            Controller-->>-Client: 403 Account banned
            Client-->>User: Display ban message
        else Account Active
            Controller->>Controller: bcrypt.compare(password, password_hash)
            
            alt [password invalid]
                Controller-->>-Client: 401 Invalid email or password
                Client-->>User: Display error message
            else [password valid]
                Controller->>Controller: jwt.sign(payload, JWT_SECRET)
                Controller-->>-Client: 200 { token, user }
                Client->>Client: Client stores token\n(localStorage / cookie)
                Client-->>-User: Redirect to home page\nDisplay success message
            end
        end
    end
    
    Note over User,DB: Figure: Sequence diagram for "Login" functionality

